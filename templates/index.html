<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>E-Trike Passenger Counter</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            margin-bottom: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .card-title {
            font-size: 1.2rem;
            font-weight: 500;
        }
        .card-text-total {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .card-text-detail {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.85);
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <h1 class="text-center mb-5">E-Trike Passenger Dashboard</h1>
        
        <h3 class="mt-5 mb-3">Live Counters</h3>
        <div class="row">
            <div class="col-md-3">
                <div class="card text-center text-white bg-primary">
                    <div class="card-body">
                        <h5 class="card-title">Hourly</h5>
                        <p class="card-text-total" id="hourly-count">0</p>
                        <p class="card-text-detail">Adults: <span id="hourly-adult">0</span> | Children: <span id="hourly-child">0</span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center text-white bg-success">
                    <div class="card-body">
                        <h5 class="card-title">Daily</h5>
                        <p class="card-text-total" id="daily-count">0</p>
                        <p class="card-text-detail">Adults: <span id="daily-adult">0</span> | Children: <span id="daily-child">0</span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center text-white bg-info">
                    <div class="card-body">
                        <h5 class="card-title">Weekly</h5>
                        <p class="card-text-total" id="weekly-count">0</p>
                        <p class="card-text-detail">Adults: <span id="weekly-adult">0</span> | Children: <span id="weekly-child">0</span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center text-white bg-warning">
                    <div class="card-body">
                        <h5 class="card-title">Monthly</h5>
                        <p class="card-text-total" id="monthly-count">0</p>
                        <p class="card-text-detail">Adults: <span id="monthly-adult">0</span> | Children: <span id="monthly-child">0</span></p>
                    </div>
                </div>
            </div>
        </div>

        <h3 class="mt-5 mb-3">Historical Summary</h3>
        <div class="row">
            <div class="col-md-6">
                <h4>Daily Totals</h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Date</th>
                            <th>Total Passengers</th>
                            <th>Adults</th>
                            <th>Children</th>
                        </tr>
                    </thead>
                    <tbody id="daily-history-body">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            <div class="col-md-6">
                <h4>Weekly Totals</h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Week Of</th>
                            <th>Total Passengers</th>
                            <th>Adults</th>
                            <th>Children</th>
                        </tr>
                    </thead>
                    <tbody id="weekly-history-body">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            <div class="col-md-6">
                <h4>Monthly Totals</h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Month Of</th>
                            <th>Total Passengers</th>
                            <th>Adults</th>
                            <th>Children</th>
                        </tr>
                    </thead>
                    <tbody id="monthly-history-body">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        function updateCounts() {
            fetch('/data')
                .then(response => response.json())
                .then(data => {
                    // Hourly
                    document.getElementById('hourly-count').textContent = data.hourly?.total || 0;
                    document.getElementById('hourly-adult').textContent = data.hourly?.Adult || 0;
                    document.getElementById('hourly-child').textContent = data.hourly?.Child || 0;
                    
                    // Daily
                    document.getElementById('daily-count').textContent = data.daily?.total || 0;
                    document.getElementById('daily-adult').textContent = data.daily?.Adult || 0;
                    document.getElementById('daily-child').textContent = data.daily?.Child || 0;

                    // Weekly
                    document.getElementById('weekly-count').textContent = data.weekly?.total || 0;
                    document.getElementById('weekly-adult').textContent = data.weekly?.Adult || 0;
                    document.getElementById('weekly-child').textContent = data.weekly?.Child || 0;

                    // Monthly
                    document.getElementById('monthly-count').textContent = data.monthly?.total || 0;
                    document.getElementById('monthly-adult').textContent = data.monthly?.Adult || 0;
                    document.getElementById('monthly-child').textContent = data.monthly?.Child || 0;
                });
        }

        function updateHistoricalData() {
            fetch('/historical-data')
                .then(response => response.json())
                .then(data => {
                    const dailyBody = document.getElementById('daily-history-body');
                    const weeklyBody = document.getElementById('weekly-history-body');
                    const monthlyBody = document.getElementById('monthly-history-body');
                    dailyBody.innerHTML = '';
                    weeklyBody.innerHTML = ''; // Clear existing rows
                    monthlyBody.innerHTML = '';

                    // Populate daily history
                    data.daily.forEach(record => {
                        const row = `<tr>
                            <td>${record.date}</td>
                            <td>${record.totals.total || 0}</td>
                            <td>${record.totals.Adult || 0}</td>
                            <td>${record.totals.Child || 0}</td>
                        </tr>`;
                        dailyBody.innerHTML += row;
                    });

                    // Populate weekly history
                    data.weekly.forEach(record => {
                        const row = `<tr>
                            <td>${record.week_of}</td>
                            <td>${record.totals.total || 0}</td>
                            <td>${record.totals.Adult || 0}</td>
                            <td>${record.totals.Child || 0}</td>
                        </tr>`;
                        weeklyBody.innerHTML += row;
                    });

                    // Populate monthly history
                    data.monthly.forEach(record => {
                        const row = `<tr>
                            <td>${record.month_of}</td>
                            <td>${record.totals.total || 0}</td>
                            <td>${record.totals.Adult || 0}</td>
                            <td>${record.totals.Child || 0}</td>
                        </tr>`;
                        monthlyBody.innerHTML += row;
                    });
                });
        }

        // Update every 5 seconds
        setInterval(updateCounts, 5000);

        // Initial update
        updateCounts();
        updateHistoricalData();
    </script>
</body>
</html> 